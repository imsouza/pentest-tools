import socket
import struct

sniffer = socket.socket(socket.AF_INET, socket.SOCK_RAW, socket.IPPROTO_IP)

while True:
  package = sniffer.recvfrom(65565)

  translated = struct.unpack('!BBHHHBBH4s4s', package[0][:20])

  print 'From:', package[1][0]
  print 'Package:', translated
  print 'IP Version:', translated[0] >> 4
  print 'TTL:', translated[5]
  print 'Protocol:', translated[6]
  print 'Source IP:', socket.inet_ntoa(translated[8])
  print 'Target IP:', socket.inet_ntoa(translated[9])

